# Genetic Algorithm

```{prf:algorithm} Genetic Algorithm
:label: GA

**Inputs** population size $N$

**Output** best individual $\mathbf{x}_{best}$

1. Initialize population $P$ with $N$ individuals
2. While not converged:
    1. $P' \leftarrow \emptyset$
    2. While $|P'| < n$:
        1. Select parents $\mathbf{x}_1, \mathbf{x}_2$ from $P$
        2. Generate offspring $\mathbf{x}_1', \mathbf{x}_2'$ by crossover
        3. Mutate $\mathbf{x}_1'$ and $\mathbf{x}_2'$
        4. $P' \leftarrow P' \cup \{\mathbf{x}_1', \mathbf{x}_2'\}$
    3. $P \leftarrow P'$
3. $\mathbf{x}_{best} \leftarrow \arg\min_{\mathbf{x} \in P} f(\mathbf{x})$
```

## Overview

Genetic algorithms (GA) are a representive type of evolutionary algorithms. They are based on the idea of natural selection and evolution. In GA, the solutions are represented as chromosomes. The algorithm starts with a population of initial solutions and then evolves them to find the best solution. During the evolution, the chromosomes with better fitness are more likely to be selected for reproduction.

GA is a popular optimization algorithm and is widely used in various problems. It is particularly useful for problems binary variables and sequencing problems. By using special operations, GA can also be applied to continuous and integer optimization problems.

GA has four main operators: initialization, selection, crossover, and mutation.

## Initialization

GA is a population-based algorithm. It starts with a population of chromosomes. A common way to initialize the population is to randomly generate chromosomes within the search space.

## Selection

The selection operator is used to select the chromosomes for reproduction. The basic idea of these methods is the chromosomes with better fitness are more likely to be selected. The following are the most common selection methods:

- Tournament selection
- Roulette wheel selection
- Rank-based selection

### Tournament Selection

In tournament selection, a subset of the population is randomly selected and the chromosome with the best fitness is chosen for reproduction. The size of the subset is called the tournament size. The tournament size is a parameter of the algorithm and can be tuned.

### Roulette Wheel Selection

In roulette wheel selection, the probability of selecting a chromosome is related to its fitness. For minimization problems, we can first transfer the fitness of chromosome $i$ to 

$$
fitness(\mathbf{x}_i) \leftarrow \max_{j=1}^n f(\mathbf{x}_j) - f(\mathbf{x}_i)
$$

where $fitness(\mathbf{x}_i)$ is the fitness of chromosome $i$ and $n$ is the population size. Then, we can calculate the probability of selecting chromosome $i$ as 

$$p_i = \frac{f(\mathbf{x}_i)}{\sum_{j=1}^n f(\mathbf{x}_j)}$$

The chromosome is selected by generating a random number between 0 and 1 (spinning the roulette wheel).

```python
import numpy as np

def roulette_wheel_selection(population, fitness):
    n = len(population)
    p = fitness / np.sum(fitness)
    idx = np.random.choice(n, p=p)
    return population[idx]

population = np.random.rand(10, 2)
fitness = np.random.rand(10)
selected = roulette_wheel_selection(population, fitness)
```

### Rank-based Selection


## Crossover

The crossover operator is used to create new chromosomes by combining the information of two parent chromosomes. For different types of problems, there are different crossover methods. For binary variables, the most common crossover methods are *one-point crossover* and *two-point crossover*. The order-crossover (OX) can be used for sequencing problems. For continuous variables, the simulated binary crossover (SBX) is a popular method.

### One-Point and Two-Point Crossover

In one-point crossover, a random point is selected and the information of the two parent chromosomes is exchanged.

In two-point crossover, two random points are selected and the information between the two points is exchanged.

### Order Crossover (OX)

In sequence problems, it is important to maintain the chromosome as a valid sequence, a permutation of the numbers from 1 to $$n$$. The order-crossover (OX) is a method that can maintain the validity of the sequence.

### Simulated Binary Crossover (SBX)

In simulated binary crossover, the offspring is generated by $$y_1 = 0.5[(1+\beta)x_1 + (1-\beta)x_2]$$ and $$y_2 = 0.5[(1-\beta)x_1 + (1+\beta)x_2]$$, where $$x_1$$ and $$x_2$$ are the parent chromosomes and $$\beta$$ is a parameter.

## Mutation
